<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

<style>
  .class-icon {
    text-align: center;
    margin-top: 15px;
  }
  .header-spacing {
    margin-top: 15px;
  }
  .toggle.ios, .toggle-on.ios, .toggle-off.ios {
    border-radius: 20px;
    background-color: #D8D8D8;
  }
</style>

<div class="row">
  <div class="col-12 col-md-12 col-lg-12" style="margin-bottom: 25px; display:flex">
    <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;" onclick="helpMe()"> <i class="fal fa-question"></i> </button>
    <span style="margin-top: 15px; margin-left: 10px"><h2> Besoin d'aide ?</h2></span>
  </div>
  {{#each pools as |pool| }}
    <div class="col-12 col-md-12 col-lg-4 card-competence">
      <div class="card">
        <div class="card-header header-spacing">
          <div class="row">
            <div class="col-md-10" id="{{pool.pool.id}}">
              <h3 class="card-title"><i class="fal fa-school"></i> {{pool.pool.name}}</h3>
            </div>
            <div class="col-md-2">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="toggle{{pool.id}}" name="PoolState" {{#if pool.available}} checked="" {{else}}{{/if}}>
                <label class="custom-control-label" for="toggle{{pool.id}}"></label>
              </div>
            </div>
            <div class="col-md-12">
              <h5><i> Référent: {{pool.pool.referent}} </i></h5>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 class-icon">
              <a href="#">
                <i title="Mes disponibilités" class="fal fa-calendar-alt fa-2x" data-pool="{{pool.id}}" onclick="editDisponibility(this)"></i>
              </a>
            </div>
            <div class="col-md-3 class-icon">
              <a href="#">
                <i title="Télécharger mon planning de service" class="fal fa-paperclip fa-2x"></i>
              </a>
            </div>
            <div class="col-md-3 class-icon">
              <a href="#">
                <i title="Choisir mes établissements" class="fal fa-hospital-user fa-2x"></i>
              </a>
            </div>
            <div class="col-md-3 class-icon">
              <a href="#">
                <i title="Choisir mes services" class="fal fa-stethoscope fa-2x" data-pool="{{pool.id}}" onclick="servicesEdit(this)"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  {{/each}}
</div>
<script>
  let helpMe = () => {
    createModal({
      id: 'helpModal',
      title: `Notices d'utilisation des pools`,
      modal: 'candidate/helpPool'
    }, () => {

    })
  };
  let serviceArray = [];
  let servicesEdit = (selectedPool) => {
    createModal({
      id: 'serviceEditModal',
      title: `Ajouter un service`,
      modal: 'candidate/serviceAdd'
    }, () => {
      $('#addServiceButton').click(function () {
        if ($('#servicesSelect').val() !== '' && $('#experienceInput').val()) {
          let _csrf = $('meta[name="csrf-token"]').attr('content');
          let pool = selectedPool.dataset.pool;
          let service =
          $.post(``)
        }
      })
    })
  };
  let editDisponibility = (selectedPool) => {
    createModal({
      id: 'serviceEditModal',
      title: `Choisir mes disponibilités`,
      modal: 'candidate/poolAvailability',
      size: 'modal-xl',
      pool: selectedPool.dataset.pool,
    }, () => {

    });
  };

  let seeMyServices = () => {
    $('#serviceEditModal').modal('hide');
    createModal({
      id: 'seeServicesModal',
      title: `Modifier les services désirés`,
      modal: 'candidate/serviceEdit'
    }, () => {

    })
  }
</script>
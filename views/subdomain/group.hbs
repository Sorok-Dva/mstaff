<!-- HEADER -->
<script>let map, marker, cityCircle, markers = [], pos = { lat: 0, lng: 0, rayon: 5 };</script>
<div class="header">
  <!-- Image -->
  <img src="{{group.banner}}" class="header-img-top" alt="Bannière {{group.name}}" style="object-fit: cover; height: 344px">
  <div class="container-fluid">
    <!-- Body -->
    <div class="header-body mt-n5 mt-md-n6">
      <div class="row align-items-end">
        <div class="col-auto">
          <!-- Avatar -->
          <div class="avatar avatar-xxl header-avatar-top">
            <img src="{{group.logo}}" alt="Logo {{group.name}}" class="avatar-img rounded border border-4 border-body">
          </div>

        </div>
        <div class="col mb-3 ml-n3 ml-md-n2">
          <!-- Pretitle -->
          <h6 class="header-pretitle">
            Page groupe
          </h6>

          <!-- Title -->
          <h1 class="header-title">
            {{group.name}}
          </h1>
        </div>
        <div class="col-12 col-md-auto mt-2 mt-md-0 mb-md-3">
          <!-- Button -->
          <a href="/join" class="btn btn-outline-primary d-block d-md-inline-block">
            Candidature spontanée
          </a>
        </div>
      </div> <!-- / .row -->
    </div> <!-- / .header-body -->
  </div>
</div> <!-- / .header -->

<!-- CONTENT -->
<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-xl-8">
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col">
              <!-- Title -->
              <h4 class="card-header-title">
                Il y a <b>{{group.es.length}}</b> établissements dans ce groupe
              </h4>
            </div>
          </div> <!-- / .row -->
        </div>
        <div class="card-body">
          {{#each group.es as |es|}}
            <div class="card" {{!--onmouseover="addMarker({lat: {{es.ref.lat}}, lon: {{es.ref.lon}} })" onmouseleave="removeAllMarker()"--}}>
              <div class="card-body">
                {{es.name}}
              </div>
            </div>
          {{!--
            <script>
              pos = {lat: {{es.ref.lat}}, lng: {{es.ref.lon}}, rayon: 5}
            </script>
            --}}
          {{/each}}
        </div>
      </div>
    </div>
    {{!--
    <div class="col-12 col-xl-4">
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col">
              <!-- Title -->
              <h4 class="card-header-title">
                Carte du groupe
              </h4>
            </div>
          </div> <!-- / .row -->
        </div>
        <div class="card-body">
          <div id="map" style="height: 450px;width: 100%;"></div>
        </div> <!-- / .card-body -->
      </div> <!-- / .card -->
    </div>
    --}}
  </div> <!-- / .row -->
</div>
{{!--
<script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMyQuBw8EQ6YixI2_Fxbw_OSmyVnnVocI&libraries=places"></script>
<script>
  if (document.getElementById('map')) {
    {{!--let pos = {lat: {{ref.lat}}, lng: {{ref.lon}}, rayon: 5};-- }}
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 10,
      center: pos
    });
    marker = new google.maps.Marker({
      position: pos,
      map: map
    });
    cityCircle = new google.maps.Circle({
      strokeColor: '#337AB7',
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillColor: '#5BBBE5',
      fillOpacity: 0.35,
      map: map,
      center: pos,
      radius: pos.rayon * 1000 || 10000
    });
  }

  let addMarker = (es) => {
    let marker = new google.maps.Marker({
      map: map,
      position: { lat: es.lat, lng: es.lon },
      icon: {
        url: 'http://maps.gstatic.com/mapfiles/circle.png',
        anchor: new google.maps.Point(10, 10),
        scaledSize: new google.maps.Size(10, 17)
      }
    });

    markers.push(marker);

    google.maps.event.addListener(marker, 'click', function () {
      var infoWindow = new google.maps.InfoWindow();
      infoWindow.setContent(es.name);
      infoWindow.open(map, marker);
    });
  };

  let removeAllMarker = () => {
    markers.forEach((marker, index) => {
      marker.setMap(null);
    });
    markers = [];
  };
</script>
--}}